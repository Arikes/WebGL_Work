<!DOCTYPE html>
<html lang="en">
	<head>
		<title>webGL demo</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				font-family: Monospace;
				background-color: #000;
				color: #000;
				margin: 10px;
				overflow: hidden;
			}

		</style>
		
		<script type="text/javascript">
            var playgrounds = null;
		</script>

	</head>

	<body>		
	</div>
		<script src="js/three.min.js"></script>
		<script src="js/libs/dat.gui.min.js"></script>
		
		<script src="js/Detector.js"></script>
		<script src="js/controls/OrbitControls.js"></script>
		<script src="js/libs/stats.min.js"></script>
		<script>
			var targetObj = new THREE.Vector3(0,0,0);
			var container, stats;
			var camera, scene, renderer;
			var directionlightPos=0;
			var directionLight;
			var wireFrameMode = false;

			
			if ( ! Detector.webgl )
				Detector.addGetWebGLMessage();
			init();
			animate();

			function initUI()
			{
				var API = {
					'zoomvalue':100,
					'directionalLight':10,
					'wireFrame'    	: true
				};		
	
				var gui = new dat.GUI();
				gui.add( API, "zoomvalue", 0, 1000, 10 ).onChange(function()
					{
						camera.setFocalLength(API['zoomvalue']);
					});
				gui.add( API, "directionalLight", 0, 1000, 5 ).onChange(function()
					{
						directionlightPos=API['directionalLight'];
						directionLight.position.set( 0,directionlightPos, 0 );
					});									
				gui.add( API, 'wireFrame' ).onChange( function() {
					wireFrameMode = !wireFrameMode;
				} );		
			}

			function init() {
				
				initUI();

				container = document.createElement( 'div' );
				document.body.appendChild( container );

				// scene
				scene = new THREE.Scene();
//				scene.fog=new THREE.Fog(0xc0c0c0,200,1000);
				// camera
				camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 1, 10000 );
				camera.position.x = 500;
				camera.position.y = 500;
				camera.position.z = 500;
				scene.add( camera );
				camera.lookAt(targetObj);
				
				// lights
				scene.add( new THREE.AmbientLight( 0xffffff ) );				
				directionLight = new THREE.DirectionalLight( 0xffffff, 1.0 );
				directionLight.position.set( 0 ,directionlightPos, 0 );
				scene.add( directionLight );


				var loader = new THREE.TextureLoader();
				var groundTexture = loader.load( 'textures/self.jpg' );
				groundTexture.wrapS = groundTexture.wrapT = THREE.RepeatWrapping;
				groundTexture.repeat.set( 2, 2 );
				groundTexture.anisotropy = 16;

				var groundMaterial = new THREE.MeshPhongMaterial( { color: 0xffffff, specular: 0XFFFFFF, map: groundTexture } );
				var mesh = new THREE.Mesh( new THREE.PlaneBufferGeometry( 1000, 1000 ), groundMaterial );
				mesh.rotation.x = -Math.PI/2.0;
				mesh.receiveShadow = true;
				scene.add( mesh );		
				
				var sphere = createMesh(new THREE.SphereGeometry(5, 20, 20), "textures/self.jpg");
				sphere.position.y = 80;
				scene.add(sphere);			
				
//new THREE.LineBasicMaterial({color:0x0000ff})

				var pt1 = new THREE.Vector3(0,0,0);
				var pt2 = new THREE.Vector3(100,0,100);
				var pt3 = new THREE.Vector3(100,0,0);
				var tri = new THREE.Triangle(pt1,pt2,pt3);
//				var myMesh = new THREE.Mesh(tri,new THREE.LineBasicMaterial({color:0x0000ff}));
//				scene.add(myMesh);

		        var stone1 = createMesh(new THREE.BoxGeometry(300, 200, 5), "textures/stone2.jpg","textures/self.jpg");
		        stone1.rotation.y = 0;
		        stone1.position.x = 0;
		        scene.add(stone1);       
		        
		        var stone2= createMesh(new THREE.BoxGeometry(300, 200, 5), "textures/stone2.jpg","textures/self.jpg");
		        stone2.rotation.y = 0;
		        stone2.position.x = 0;
		        stone2.position.z = 100;
		        scene.add(stone2);       		        
		        
				renderer = new THREE.WebGLRenderer( { antialias: true } );
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );
				renderer.setClearColor( 0x000000);
				
				container.appendChild( renderer.domElement );

				renderer.shadowMap.enabled = false;
				// controls
				var controls = new THREE.OrbitControls( camera, renderer.domElement );
				controls.maxPolarAngle = Math.PI * 0.4;
				controls.minDistance = 0;
				controls.maxDistance = 3000;

				stats = new Stats();
				container.appendChild( stats.dom );

				window.addEventListener( 'resize', onWindowResize, false );
			}

			function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );
			}

			function animate() {
				requestAnimationFrame( animate );
				render();
				stats.update();
			}

			function render() {
					camera.lookAt(targetObj);
					renderer.render( scene, camera );
			}

			function createMesh(geom, imageFile,bump) {
            var texture = THREE.ImageUtils.loadTexture(imageFile);
            geom.computeVertexNormals();
//			var mat = new THREE.MeshPhongMaterial( { color: 0xffffff, specular: 0xff0000} );      
            var mat = new THREE.MeshLambertMaterial( { } );      
            mat.wireframe = wireFrameMode;
            mat.map = texture;
            if (bump) {
                var bump = THREE.ImageUtils.loadTexture(bump);
                mat.bumpMap = bump;
                mat.bumpScale = 5;
            }
            var mesh = new THREE.Mesh(geom, mat);
            return mesh;
			}

		</script>

	</body>
</html>
